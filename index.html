<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>VetDesk MVP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Minimal Tailwind CSS via CDN for prototype (switch to local build for prod) -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-blue-900 text-white p-4 flex items-center justify-between">
    <h1 class="text-2xl font-bold">VetDesk</h1>
    <span class="text-sm font-medium">VA Benefits Companion</span>
  </header>

  <main class="flex-1 flex flex-col md:flex-row overflow-hidden">

    <!-- News Feed -->
    <section class="w-full md:w-1/3 bg-white border-r border-gray-200 overflow-y-auto p-4 flex flex-col" style="min-width:300px;">
      <h2 class="text-xl font-semibold mb-3">News Feed</h2>
      <ul id="news-feed" class="space-y-4 flex-1">
        <!-- News items will be inserted here -->
      </ul>
    </section>

    <!-- Chat Section -->
    <section class="flex-1 flex flex-col h-full bg-gray-50">
      <!-- Quick Actions -->
      <div id="quick-actions" class="flex flex-wrap gap-2 p-4 bg-white border-b border-gray-200">
        <!-- Buttons inserted by JS -->
      </div>
      <!-- Chat History -->
      <div id="chat-history" class="flex-1 overflow-y-auto p-4 space-y-4">
        <!-- Messages inserted by JS -->
      </div>
      <!-- Chat Input -->
      <form id="chat-form" class="flex gap-2 p-4 bg-white border-t border-gray-200" autocomplete="off">
        <input id="chat-input" type="text" class="flex-1 border rounded px-3 py-2 focus:outline-blue-600" placeholder="Type your message..." autocomplete="off" required />
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800 transition">Send</button>
      </form>
    </section>
  </main>

  <script>
    // ====== Main Quick Actions (static) ======
    const quickActions = [
      { text: "What are VA disability ratings?", label: "Disability Ratings" },
      { text: "How do VA appeals work?", label: "Appeals Process" },
      { text: "What is VA healthcare coverage?", label: "Healthcare" },
      { text: "What VA benefits am I eligible for?", label: "Eligibility" },
      { text: "How do I file VA claims online?", label: "Filing Claims" }
    ];

    // ====== Example News Feed Data (replace with live fetch as needed) ======
    const newsItems = [
      {
        title: "VA Announces New Policy Updates",
        url: "#",
        date: "2025-07-16",
        summary: "The Department of Veterans Affairs has announced updates to streamline disability claim processing."
      },
      {
        title: "Expanded Healthcare Access for Veterans",
        url: "#",
        date: "2025-07-14",
        summary: "New legislation now allows more veterans to qualify for VA healthcare coverage."
      },
      {
        title: "GI Bill Application Window Extended",
        url: "#",
        date: "2025-07-10",
        summary: "Veterans have more time to apply for the GI Bill thanks to a recent policy extension."
      }
    ];

    // ====== Render News Feed ======
    function renderNewsFeed() {
      const feed = document.getElementById('news-feed');
      feed.innerHTML = "";
      newsItems.forEach(item => {
        const li = document.createElement('li');
        li.className = "p-3 bg-gray-50 border rounded shadow-sm";
        li.innerHTML = `
          <a href="${item.url}" class="font-semibold text-blue-800 hover:underline" target="_blank" rel="noopener">${item.title}</a>
          <div class="text-xs text-gray-500 mb-1">${item.date}</div>
          <div>${item.summary}</div>
        `;
        feed.appendChild(li);
      });
    }

    // ====== Render Quick Actions ======
    function renderQuickActions() {
      const qa = document.getElementById('quick-actions');
      qa.innerHTML = "";
      quickActions.forEach(action => {
        const btn = document.createElement('button');
        btn.type = "button";
        btn.className = "bg-blue-100 text-blue-900 px-3 py-1 rounded hover:bg-blue-200 transition text-sm font-medium";
        btn.textContent = action.label;
        btn.onclick = () => {
          document.getElementById('chat-input').value = action.text;
          document.getElementById('chat-input').focus();
        };
        qa.appendChild(btn);
      });
    }

    // ====== Chat State ======
    let chatMessages = [];

    // ====== Render Chat History ======
    function renderChatHistory() {
      const ch = document.getElementById('chat-history');
      ch.innerHTML = "";
      chatMessages.forEach(msg => {
        const div = document.createElement('div');
        div.className = "flex";
        if (msg.sender === "user") {
          div.className += " justify-end";
          div.innerHTML = `<div class="bg-blue-600 text-white px-4 py-2 rounded-lg max-w-md text-right ml-auto">${msg.text}</div>`;
        } else {
          div.innerHTML = `<div class="bg-gray-200 text-gray-900 px-4 py-2 rounded-lg max-w-md">${msg.text}</div>`;
        }
        ch.appendChild(div);
      });
      ch.scrollTop = ch.scrollHeight;
    }

    // ====== Simulated Chatbot (replace with API integration) ======
    async function getBotReply(userText) {
      // Email feature: if user requests email, simulate a reply
      if (/email( me| this)?/i.test(userText)) {
        return "Sure! Please provide your email address so I can send you the information.";
      }
      // Simulated answers for quick actions
      if (/disability ratings/i.test(userText)) {
        return "VA disability ratings are assigned based on the severity of your service-connected condition. Would you like more details?";
      }
      if (/appeals/i.test(userText)) {
        return "The VA appeals process allows you to challenge a decision about your benefits. There are several appeal lanes. Would you like a step-by-step overview?";
      }
      if (/healthcare/i.test(userText)) {
        return "VA healthcare provides a range of medical services to eligible veterans. Coverage varies depending on priority group and service history.";
      }
      if (/eligible for/i.test(userText)) {
        return "Eligibility for VA benefits depends on your service history, discharge status, and other factors. Tell me more about your situation for a personalized overview.";
      }
      if (/file.*claim/i.test(userText)) {
        return "You can file a VA claim online through VA.gov. Do you need a step-by-step guide or help gathering required forms?";
      }
      // Default reply
      return "I'm here to help with VA benefits questions. Please ask anything!";
    }

    // ====== Handle Chat Submission ======
    document.getElementById('chat-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const input = document.getElementById('chat-input');
      const text = input.value.trim();
      if (!text) return;
      // Add user message
      chatMessages.push({ sender: "user", text });
      renderChatHistory();
      input.value = "";
      // Simulate bot thinking
      setTimeout(async () => {
        const reply = await getBotReply(text);
        chatMessages.push({ sender: "bot", text: reply });
        renderChatHistory();
      }, 600);
    });

    // ====== Initialize UI ======
    renderNewsFeed();
    renderQuickActions();
    renderChatHistory();
  </script>
</body>
</html>